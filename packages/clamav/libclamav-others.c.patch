--- a/libclamav/others.c
+++ b/libclamav/others.c
@@ -22,6 +22,7 @@
 #include <stdarg.h>
 #include <string.h>
 #include <stdlib.h>
+#include <limits.h>
 #include <ctype.h>
 #ifdef HAVE_UNISTD_H
 #include <unistd.h>
@@ -26,6 +27,13 @@
 #ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
+
+/* When building with -std=gnu90, some toolchains may not provide LLONG_MAX
+ * even though 'long long' exists as an extension. */
+#ifndef LLONG_MAX
+#define LLONG_MAX __LONG_LONG_MAX__
+#endif
+
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <dirent.h>
